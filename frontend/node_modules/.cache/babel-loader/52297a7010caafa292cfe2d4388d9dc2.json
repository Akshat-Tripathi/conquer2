{"ast":null,"code":"import _slicedToArray from\"/Users/shashwatkansal/Documents/Shashwat/Projects/conquer2/V0.2/conquer2/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _classCallCheck from\"/Users/shashwatkansal/Documents/Shashwat/Projects/conquer2/V0.2/conquer2/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/shashwatkansal/Documents/Shashwat/Projects/conquer2/V0.2/conquer2/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/shashwatkansal/Documents/Shashwat/Projects/conquer2/V0.2/conquer2/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/shashwatkansal/Documents/Shashwat/Projects/conquer2/V0.2/conquer2/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component,useState}from\"react\";import{ComposableMap,Geographies,Geography,ZoomableGroup}from\"react-simple-maps\";import ReactTooltip from\"react-tooltip\";// import { useSpring, animated } from \"react-spring\";\nimport\"./Map.css\";import{connect,loaddetails}from\"../api/index.js\";import Intro2 from\"../shashgonenuts/intro2\";import{username}from\"./Home.jsx\";import mapdata from\"../maps/world.txt\";var geoUrl=\"https://raw.githubusercontent.com/zcreativelabs/react-simple-maps/master/topojson-maps/world-110m.json\";var countries={};var socket=null;var GameMap=/*#__PURE__*/function(_Component){_inherits(GameMap,_Component);var _super=_createSuper(GameMap);function GameMap(){var _this;_classCallCheck(this,GameMap);_this=_super.call(this);socket=connect();socket.onmessage=function(msg){console.log(msg);};return _this;}_createClass(GameMap,[{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(SideBar,null);}}]);return GameMap;}(Component);function SideBar(){//Fetch #troops, attack, move options, fix data vals\nvar _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),name=_useState4[0],setname=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),pop_est=_useState6[0],setpop_est=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),gdp=_useState8[0],setgdp=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),subrg=_useState10[0],setsubrg=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),continent=_useState12[0],setcontinent=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),display=_useState14[0],setdisplay=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),clickedCountry=_useState16[0],setclickedCountry=_useState16[1];var handleclickedCountry=function handleclickedCountry(ISO_A2){if(clickedCountry===\"\"){setclickedCountry(ISO_A2);}else{setclickedCountry(\"\");}};var CountryDetails=function CountryDetails(){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h2\",null,\"Spy Report On \",name,\":\"),/*#__PURE__*/React.createElement(\"h3\",null,\"Population: \",pop_est),/*#__PURE__*/React.createElement(\"h3\",null,\"GDP (PPP): \",gdp),continent!==\"South America\"&&/*#__PURE__*/React.createElement(\"h3\",null,\"Subregion: \",subrg),/*#__PURE__*/React.createElement(\"h3\",null,\"Continent: \",continent));};var handleColourFill=function handleColourFill(country){var ISO_A2=country.properties.ISO_A2;if(clickedCountry!==\"\"&&getCountryCodes(clickedCountry).includes(ISO_A2)){return\"#000\";}return\"#FFF\";};var handleColourStroke=function handleColourStroke(country){var ISO_A2=country.properties.ISO_A2;return\"#FFF\";};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"map-sidebar-wrapper\"},/*#__PURE__*/React.createElement(\"div\",{className:\"map-sidebar-info-wrapper\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h1\",null,\"START THE CONQUEST!\"),/*#__PURE__*/React.createElement(\"h2\",null,\"Welcome Commander \",username,\"!\")),/*#__PURE__*/React.createElement(\"p\",null,\"This is your war control room. Help us attain victory over our enemies. The Gods are on our side!\"),clickedCountry!==\"\"&&/*#__PURE__*/React.createElement(\"p\",null,\"Clicked Country: \",clickedCountry),display&&/*#__PURE__*/React.createElement(CountryDetails,null))),/*#__PURE__*/React.createElement(MapSettings,{setTooltipContent:setState,setname:setname,setgdp:setgdp,setpop_est:setpop_est,setdisplay:setdisplay,setcontinent:setcontinent,setsubrg:setsubrg,setclickedCountry:handleclickedCountry,handleColourFill:handleColourFill,handleColourStroke:handleColourStroke}),/*#__PURE__*/React.createElement(ReactTooltip,null,state));}var getnum=function getnum(num){var num=Math.round(num);if(num>Math.pow(10,12)){num=num/Math.pow(10,12)+\" Trillion\";}else if(num>Math.pow(10,9)){num=num/Math.pow(10,9)+\" Billion\";}else if(num>Math.pow(10,6)){num=num/Math.pow(10,6)+\" Million\";}return num;};//Countries to not display\nfunction notThisCountry(country){var NAME=country.properties.NAME;return NAME!==\"\";}var clickedCountry;//TODO: player team colour for country\nfunction countryColors(country){var _country$properties=country.properties,NAME=_country$properties.NAME,ISO_A2=_country$properties.ISO_A2;return\"#AAA\";}function loadMap(){var situation=document.cookie.split(\"; \").map(function(s){return s.split(\"=\");}).filter(function(arr){return arr[0]==\"situation\";})[0][1];var fileURL=\"/maps/\"+situation+\".txt\";var countries={};var raw=\"\";fetch(fileURL).then(function(line){return line.text();}).then(function(line){return line.split(\"\\n\");}).then(function(data){return raw=data;});console.log(raw);var borders=[];for(var i=0;i<raw.length;i++){borders=[];var line=raw[i].split(\" \");countries[line[0]]=line.slice(1);}return countries;}function getBorder(countrycode){return countries[countrycode];}//FIXME: fix read file correctly\nfunction getCountryCodes(countrycode){state={borderingCountries:[]};// var fs = require(\"fs\");\nvar fileURL=\"/maps/world.txt\";var textByLine=fetch(fileURL).then(function(response){return response.text();}).then(function(data){var borderdata=data.split(\"\\n\").toString();console.log(data.split(\"\\n\").toString());//\nvar countriesBordering=[];//Processing\nfor(var j=0;j<borderdata.length;j++){var borders=borderdata[j].split(\" \");if(borders[0]==countrycode){for(var i=1;i<borders.length;i++){//Get border codes\ncountriesBordering.push(borders[i]);}}}this.borderingCountries.setState(countriesBordering);});return this.state.borderingCountries;}var MapSettings=function MapSettings(_ref){var setTooltipContent=_ref.setTooltipContent,setname=_ref.setname,setpop_est=_ref.setpop_est,setsubrg=_ref.setsubrg,setcontinent=_ref.setcontinent,setgdp=_ref.setgdp,setdisplay=_ref.setdisplay,setclickedCountry=_ref.setclickedCountry,handleColourFill=_ref.handleColourFill,handleColourStroke=_ref.handleColourStroke;return/*#__PURE__*/React.createElement(\"div\",{className:\"map-wrapper\"},/*#__PURE__*/React.createElement(ComposableMap,{\"data-tip\":\"\"},/*#__PURE__*/React.createElement(ZoomableGroup,null,/*#__PURE__*/React.createElement(Geographies,{geography:geoUrl},function(_ref2){var geographies=_ref2.geographies;return geographies.map(function(geo){return notThisCountry(geo)?/*#__PURE__*/React.createElement(Geography,{key:geo.rsmKey,geography:geo,fill:handleColourFill(geo),stroke:handleColourStroke(geo),onMouseEnter:function onMouseEnter(){var _geo$properties=geo.properties,NAME=_geo$properties.NAME,POP_EST=_geo$properties.POP_EST,GDP_MD_EST=_geo$properties.GDP_MD_EST,SUBREGION=_geo$properties.SUBREGION,CONTINENT=_geo$properties.CONTINENT;// setTooltipContent(\n//   `${NAME} - $${getnum(GDP_MD_EST * Math.pow(10, 6))}`\n// );\nsetTooltipContent(\"\".concat(NAME,\" - ENEMY TERRITORY\"));setname(NAME);setpop_est(getnum(POP_EST));setgdp(getnum(GDP_MD_EST*Math.pow(10,6)));setsubrg(SUBREGION);setcontinent(CONTINENT);setdisplay(true);},onMouseLeave:function onMouseLeave(){setTooltipContent(\"\");setdisplay(false);},style:{default:{fill:\"#D6D6DA\",outline:\"none\"},hover:{fill:\"#F53\",outline:\"none\"},pressed:{fill:\"#D6D6DA\",outline:\"none\"}},onClick:function onClick(){var ISO_A2=geo.properties.ISO_A2;setclickedCountry(ISO_A2);}}):null;});}))));};export default GameMap;","map":{"version":3,"sources":["/Users/shashwatkansal/Documents/Shashwat/Projects/conquer2/V0.2/conquer2/frontend/src/pages/Map.jsx"],"names":["React","Component","useState","ComposableMap","Geographies","Geography","ZoomableGroup","ReactTooltip","connect","loaddetails","Intro2","username","mapdata","geoUrl","countries","socket","GameMap","onmessage","msg","console","log","SideBar","state","setState","name","setname","pop_est","setpop_est","gdp","setgdp","subrg","setsubrg","continent","setcontinent","display","setdisplay","clickedCountry","setclickedCountry","handleclickedCountry","ISO_A2","CountryDetails","handleColourFill","country","properties","getCountryCodes","includes","handleColourStroke","getnum","num","Math","round","pow","notThisCountry","NAME","countryColors","loadMap","situation","document","cookie","split","map","s","filter","arr","fileURL","raw","fetch","then","line","text","data","borders","i","length","slice","getBorder","countrycode","borderingCountries","textByLine","response","borderdata","toString","countriesBordering","j","push","MapSettings","setTooltipContent","geographies","geo","rsmKey","POP_EST","GDP_MD_EST","SUBREGION","CONTINENT","default","fill","outline","hover","pressed"],"mappings":"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","sourcesContent":["import React, { Component, useState } from \"react\";\nimport {\n  ComposableMap,\n  Geographies,\n  Geography,\n  ZoomableGroup,\n} from \"react-simple-maps\";\nimport ReactTooltip from \"react-tooltip\";\n// import { useSpring, animated } from \"react-spring\";\nimport \"./Map.css\";\nimport { connect, loaddetails } from \"../api/index.js\";\nimport Intro2 from \"../shashgonenuts/intro2\";\nimport { username } from \"./Home.jsx\";\n\nimport mapdata from \"../maps/world.txt\";\n\nconst geoUrl =\n  \"https://raw.githubusercontent.com/zcreativelabs/react-simple-maps/master/topojson-maps/world-110m.json\";\n\nvar countries = {};\nvar socket = null;\n\nclass GameMap extends Component {\n  constructor() {\n    super();\n    socket = connect();\n\n    socket.onmessage = (msg) => {\n      console.log(msg);\n    };\n  }\n\n  render() {\n    return <SideBar />;\n  }\n}\n\nfunction SideBar() {\n  //Fetch #troops, attack, move options, fix data vals\n  const [state, setState] = useState(\"\");\n\n  const [name, setname] = useState(\"\");\n  const [pop_est, setpop_est] = useState(\"\");\n  const [gdp, setgdp] = useState(\"\");\n  const [subrg, setsubrg] = useState(\"\");\n  const [continent, setcontinent] = useState(\"\");\n  const [display, setdisplay] = useState(false);\n  const [clickedCountry, setclickedCountry] = useState(\"\");\n\n  const handleclickedCountry = (ISO_A2) => {\n    if (clickedCountry === \"\") {\n      setclickedCountry(ISO_A2);\n    } else {\n      setclickedCountry(\"\");\n    }\n  };\n\n  const CountryDetails = () => {\n    return (\n      <div>\n        <h2>Spy Report On {name}:</h2>\n        <h3>Population: {pop_est}</h3>\n        <h3>GDP (PPP): {gdp}</h3>\n        {continent !== \"South America\" && <h3>Subregion: {subrg}</h3>}\n        <h3>Continent: {continent}</h3>\n      </div>\n    );\n  };\n\n  const handleColourFill = (country) => {\n    const { ISO_A2 } = country.properties;\n    if (\n      clickedCountry !== \"\" &&\n      getCountryCodes(clickedCountry).includes(ISO_A2)\n    ) {\n      return \"#000\";\n    }\n    return \"#FFF\";\n  };\n\n  const handleColourStroke = (country) => {\n    const { ISO_A2 } = country.properties;\n    return \"#FFF\";\n  };\n\n  return (\n    <div>\n      <div className=\"map-sidebar-wrapper\">\n        <div className=\"map-sidebar-info-wrapper\">\n          <div>\n            <h1>START THE CONQUEST!</h1>\n            <h2>Welcome Commander {username}!</h2>\n          </div>\n          <p>\n            This is your war control room. Help us attain victory over our\n            enemies. The Gods are on our side!\n          </p>\n          {clickedCountry !== \"\" && <p>Clicked Country: {clickedCountry}</p>}\n          {display && <CountryDetails />}\n        </div>\n      </div>\n      <MapSettings\n        setTooltipContent={setState}\n        setname={setname}\n        setgdp={setgdp}\n        setpop_est={setpop_est}\n        setdisplay={setdisplay}\n        setcontinent={setcontinent}\n        setsubrg={setsubrg}\n        setclickedCountry={handleclickedCountry}\n        handleColourFill={handleColourFill}\n        handleColourStroke={handleColourStroke}\n      />\n      <ReactTooltip>{state}</ReactTooltip>\n    </div>\n  );\n}\n\nconst getnum = (num) => {\n  var num = Math.round(num);\n  if (num > Math.pow(10, 12)) {\n    num = num / Math.pow(10, 12) + \" Trillion\";\n  } else if (num > Math.pow(10, 9)) {\n    num = num / Math.pow(10, 9) + \" Billion\";\n  } else if (num > Math.pow(10, 6)) {\n    num = num / Math.pow(10, 6) + \" Million\";\n  }\n  return num;\n};\n\n//Countries to not display\nfunction notThisCountry(country) {\n  const { NAME } = country.properties;\n  return NAME !== \"\";\n}\n\nvar clickedCountry;\n//TODO: player team colour for country\nfunction countryColors(country) {\n  const { NAME, ISO_A2 } = country.properties;\n  return \"#AAA\";\n}\n\nfunction loadMap() {\n  const situation = document.cookie\n    .split(\"; \")\n    .map((s) => s.split(\"=\"))\n    .filter((arr) => arr[0] == \"situation\")[0][1];\n  const fileURL = \"/maps/\" + situation + \".txt\";\n\n  var countries = {};\n\n  var raw = \"\";\n  fetch(fileURL)\n    .then((line) => line.text())\n    .then((line) => line.split(\"\\n\"))\n    .then((data) => (raw = data));\n\n  console.log(raw);\n  var borders = [];\n  for (let i = 0; i < raw.length; i++) {\n    borders = [];\n    var line = raw[i].split(\" \");\n    countries[line[0]] = line.slice(1);\n  }\n  return countries;\n}\n\nfunction getBorder(countrycode) {\n  return countries[countrycode];\n}\n\n//FIXME: fix read file correctly\nfunction getCountryCodes(countrycode) {\n  state = {\n    borderingCountries: [],\n  };\n  // var fs = require(\"fs\");\n  const fileURL = \"/maps/world.txt\";\n  const textByLine = fetch(fileURL)\n    .then(function (response) {\n      return response.text();\n    })\n    .then(function (data) {\n      const borderdata = data.split(\"\\n\").toString();\n      console.log(data.split(\"\\n\").toString());\n      //\n      var countriesBordering = [];\n      //Processing\n      for (let j = 0; j < borderdata.length; j++) {\n        var borders = borderdata[j].split(\" \");\n        if (borders[0] == countrycode) {\n          for (let i = 1; i < borders.length; i++) {\n            //Get border codes\n            countriesBordering.push(borders[i]);\n          }\n        }\n      }\n      this.borderingCountries.setState(countriesBordering);\n    });\n\n  return this.state.borderingCountries;\n}\n\nconst MapSettings = ({\n  setTooltipContent,\n  setname,\n  setpop_est,\n  setsubrg,\n  setcontinent,\n  setgdp,\n  setdisplay,\n  setclickedCountry,\n  handleColourFill,\n  handleColourStroke,\n}) => {\n  return (\n    <div className=\"map-wrapper\">\n      <ComposableMap data-tip=\"\">\n        <ZoomableGroup>\n          <Geographies geography={geoUrl}>\n            {({ geographies }) =>\n              geographies.map((geo) =>\n                notThisCountry(geo) ? (\n                  <Geography\n                    key={geo.rsmKey}\n                    geography={geo}\n                    fill={handleColourFill(geo)}\n                    stroke={handleColourStroke(geo)}\n                    onMouseEnter={() => {\n                      const {\n                        NAME,\n                        POP_EST,\n                        GDP_MD_EST,\n                        SUBREGION,\n                        CONTINENT,\n                      } = geo.properties;\n\n                      // setTooltipContent(\n                      //   `${NAME} - $${getnum(GDP_MD_EST * Math.pow(10, 6))}`\n                      // );\n\n                      setTooltipContent(`${NAME} - ENEMY TERRITORY`);\n                      setname(NAME);\n                      setpop_est(getnum(POP_EST));\n                      setgdp(getnum(GDP_MD_EST * Math.pow(10, 6)));\n                      setsubrg(SUBREGION);\n                      setcontinent(CONTINENT);\n                      setdisplay(true);\n                    }}\n                    onMouseLeave={() => {\n                      setTooltipContent(\"\");\n                      setdisplay(false);\n                    }}\n                    style={{\n                      default: {\n                        fill: \"#D6D6DA\",\n                        outline: \"none\",\n                      },\n                      hover: {\n                        fill: \"#F53\",\n                        outline: \"none\",\n                      },\n                      pressed: {\n                        fill: \"#D6D6DA\",\n                        outline: \"none\",\n                      },\n                    }}\n                    onClick={() => {\n                      const { ISO_A2 } = geo.properties;\n                      setclickedCountry(ISO_A2);\n                    }}\n                  />\n                ) : null\n              )\n            }\n          </Geographies>\n        </ZoomableGroup>\n      </ComposableMap>\n    </div>\n  );\n};\n\nexport default GameMap;\n"]},"metadata":{},"sourceType":"module"}